(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{15:function(e,t,i){const n=i(40),{chunkSize:o}=i(33),s={},d={},r=2;let a=void 0;function c(e,t){n(e,t),t.forEach(t=>{entities.emitter.emit(t.name+"AddedFromServer",e)})}function f(e,t){return e<=t+r&&e>=t-r}function m(e){let t=entities.create();e.forEach(e=>{entities.emitter.emit(e.name+"AddedFromChunkLoader",t)}),c(t,e)}function u(e){return Math.floor(e/o)}function l(e){return entities.find("serverId").find(t=>entities.getComponent(t,"serverId")==e)}function v(){void 0!==a&&clearTimeout(a),a=setTimeout(()=>{!function(){let e=u(entities.getComponent(entities.find("cameraFocus")[0],"body").position[0]);for(let t in s){let i=s[t];if(f(t,e)){if(!i.isLoaded){for(let e in i.entities)m(i.entities[e]);i.isLoaded=!0}}else if(i.isLoaded){for(let e in i.entities){let t=l(e);i.entities[e].forEach(e=>{entities.emitter.emit(e.name+"UnloadedFromChunk",e,t)}),entities.destroy(t)}i.isLoaded=!1}}}(),a=void 0},100)}entities.emitter.on("loaded",()=>{server.on("physics",e=>{entities.find("serverId").forEach(t=>{let i=entities.getComponent(t,"serverId");if(e[i]){let e=entities.getComponent(t,"body"),n=d[i],o=u(e.position[0]);n!=o&&function(e,t,i){let n=entities.find("cameraFocus")[0];if(void 0!==n&&entities.getComponent(n,"serverId")===e)v(),d[e]=t;else{let o=s[i],r=s[t];if(void 0!==o.entities[e])if(r.entities[e]=o.entities[e],delete o.entities[e],d[e]=t,f(t,void 0!==n?u(entities.getComponent(n,"body").position[0]):0)||void 0===l(e))void 0===l(e)&&m(r.entities[e]);else{let t=l(e);r.entities[e].forEach(e=>{entities.emitter.emit(e.name+"UnloadedFromChunk",e,t)}),entities.destroy(t)}}}(i,o,n)}})}),server.on("newEntity",e=>{let t=e.find(e=>"physicsConfig"===e.name),i=e.find(e=>"serverId"===e.name),n=entities.find("cameraFocus")[0];if(void 0!==i&&(i=i.value),e.some(e=>"cameraFocus"===e.name))console.log("and now we have our camera focus, boys and girls!");else if(t&&void 0!==i){let o=u(t.object.bodyConfig.position[0]),r=n?u(entities.getComponent(n,"body").position[0]):0;if(s[o]||(s[o]={entities:{},isLoaded:!1}),s[o].entities[i]=e,d[i]=o,!f(o,r))return;s[o].isLoaded=!0}c(entities.create(),e)}),server.on("addComponents",e=>{c(l(e.serverId),e.components)}),server.on("destroyEntity",e=>{for(chunkI in s)for(serverId in s[chunkI].entities)serverId==e&&delete s[chunkI].entities[serverId];if(void 0!==e){let t=l(e);void 0!==t&&entities.destroy(t)}})}),e.exports={}},33:function(e){e.exports={size:210,zoom:25,floorHeight:-35,chunkSize:15,zIndexLowest:0,zIndexHighest:1}},40:function(e,t){e.exports=((e,t)=>{t.forEach(t=>{void 0===entities.getComponent(e,t.name)&&entities.addComponent(e,t.name),t.object?Object.assign(entities.entities[e][t.name],t.object):void 0!==t.value&&entities.setComponent(e,t.name,t.value)})})}}]);